<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Redwood Adoption Estimator</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx-js-style@1.2.0/dist/xlsx.bundle.js"></script>

<style>
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: #f3f4f6;
}
</style>
</head>

<body>
<div id="app" class="min-h-screen p-8">
<div class="max-w-4xl mx-auto bg-white shadow-lg rounded-lg p-6">

<h1 class="text-2xl font-bold mb-4">Redwood Adoption Estimator</h1>

<div class="mb-4">
<label class="block text-sm font-bold mb-1">Customer Name</label>
<input v-model="customerName" class="border p-2 w-full rounded">
</div>

<button @click="generateExcel"
class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded">
Download Excel
</button>

</div>
</div>

<script>
const { createApp } = Vue;

const PRODUCTS = [
{ name: "Procurement", weight: 1.0 },
{ name: "Inventory Management", weight: 1.2 },
{ name: "Manufacturing", weight: 1.5 }
];

const styles = {
headerBlue: {
fill: { fgColor: { rgb: "4472C4" } },
font: { bold: true, color: { rgb: "FFFFFF" } },
alignment: { horizontal: "center", vertical: "center" },
border: {
top:{style:"thin"}, bottom:{style:"thin"},
left:{style:"thin"}, right:{style:"thin"}
}
},
sectionGray: {
fill: { fgColor: { rgb: "A5A5A5" } },
font: { bold: true, color: { rgb: "FFFFFF" } },
alignment: { horizontal: "center", vertical: "center" },
border: {
top:{style:"thin"}, bottom:{style:"thin"},
left:{style:"thin"}, right:{style:"thin"}
}
},
regular: {
border: {
top:{style:"thin"}, bottom:{style:"thin"},
left:{style:"thin"}, right:{style:"thin"}
}
},
totalGreen: {
fill: { fgColor: { rgb: "C6E0B4" } },
font: { bold: true },
alignment: { horizontal: "center", vertical: "center" },
border: {
top:{style:"thin"}, bottom:{style:"thin"},
left:{style:"thin"}, right:{style:"thin"}
}
}
};

createApp({
data() {
return {
customerName: "Global Enterprises",
products: [
{
name: "Procurement",
features: 30,
personalizations: 20
}
]
};
},

methods: {

getWeight(name){
const p = PRODUCTS.find(x => x.name === name);
return p ? p.weight : 1;
},

applyStyle(ws, range, style){
for(let R = range.s.r; R <= range.e.r; ++R){
for(let C = range.s.c; C <= range.e.c; ++C){
const addr = XLSX.utils.encode_cell({r:R,c:C});
if(ws[addr]) ws[addr].s = style;
}
}
},

generateExcel(){

const wb = XLSX.utils.book_new();

this.products.forEach(product => {

const weight = this.getWeight(product.name);
const pFeatures = product.features;
const pPers = product.personalizations;

const totalCSU = Math.round(
(pFeatures * 0.2) +
(pFeatures * 16 * weight) +
(pPers * 2)
);

const data = [

["Activity","Detailed Activity","Feature & Pers Count","CSUS"],

["Service Kick-off","","",""],

["Validate Redwood Pre-Adoption File",
"Providing Details Features list and running helper tool","",""],

["Perform Impact Assessment",
"Validating helper tool output and feature list","",""],

["Assessment Activities","","",""],

["Discussion",
"Introduction of Redwood roadmap and workplan","","0"],

["Documentation",
"CWB's and Adoption Document","","0"],

["Demo/Review",
"Walkthrough of feature before and after adoption","","0"],

["Adoption Activities","","",""],

["Configure Redwood UI Pages",
"Enablement and verification in Non-Prod and Prod",
pFeatures,
Math.round(pFeatures * 16 * weight)],

["Configure supported personalizations",
"Redo personalizations due to structural differences",
pPers,
pPers * 2],

["Unit Testing Activities and UAT Assistance","","",""],

["Perform Unit Testing",
"Column-by-column comparison between Classic and Redwood","","0"],

["Assist in UAT",
"Resolve issues raised during testing","","0"],

["Migration Activities","","",""],

["Deploy to Non-Prod",
"Configure setups and deploy personalization","","0"],

["Deploy to Production",
"Production migration of UI and setups","","0"],

["Post-Go-Live Hypercare Support","","",""],

["Post Go-live Support",
"3 weeks Hypercare support","","0"],

["Grand Total","","", totalCSU]

];

const ws = XLSX.utils.aoa_to_sheet(data);
const range = XLSX.utils.decode_range(ws['!ref']);

// Borders
for(let R=0; R<=range.e.r; ++R){
for(let C=0; C<=range.e.c; ++C){
const addr = XLSX.utils.encode_cell({r:R,c:C});
if(ws[addr]) ws[addr].s = styles.regular;
}
}

// Header style
this.applyStyle(ws,{s:{r:0,c:0},e:{r:0,c:3}},styles.headerBlue);

// Section headers
[1,4,8,11,14,17].forEach(r=>{
this.applyStyle(ws,{s:{r:r,c:0},e:{r:r,c:3}},styles.sectionGray);
});

// Grand total
this.applyStyle(ws,
{s:{r:data.length-1,c:0},e:{r:data.length-1,c:3}},
styles.totalGreen
);

ws['!cols'] = [
{wch:35},
{wch:65},
{wch:20},
{wch:15}
];

XLSX.utils.book_append_sheet(wb, ws, product.name);

});

XLSX.writeFile(wb,"Redwood_Adoption_Estimator.xlsx");
}

}

}).mount("#app");
</script>
</body>
</html>
