```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redwood Adoption Estimator</title>
    
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Vue.js 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- SheetJS for Excel Export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f3f4f6; }
        .fade-enter-active, .fade-leave-active { transition: opacity 0.3s ease; }
        .fade-enter-from, .fade-leave-to { opacity: 0; }
    </style>
</head>
<body>

<div id="app" class="min-h-screen p-8">
    <div class="max-w-7xl mx-auto bg-white shadow-lg rounded-lg overflow-hidden">
        
        <!-- Header -->
        <div class="bg-blue-900 text-white p-6 flex justify-between items-center">
            <div>
                <h1 class="text-2xl font-bold">Redwood Adoption Estimator</h1>
                <p class="text-blue-200 text-sm">Web-based Calculation Tool</p>
            </div>
            <button @click="generateExcel" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded flex items-center gap-2 transition">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /></svg>
                Download Excel
            </button>
        </div>

        <div class="p-8">
            <!-- Configuration Section -->
            <div class="mb-8 grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label class="block text-gray-700 text-sm font-bold mb-2">Customer Name</label>
                    <input v-model="customerName" type="text" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" placeholder="e.g. Global Enterprises">
                </div>
                <div class="flex items-end">
                    <button @click="addProduct" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded w-full transition">
                        + Add New Product
                    </button>
                </div>
            </div>

            <!-- Products List -->
            <div v-for="(product, pIndex) in products" :key="pIndex" class="mb-8 border rounded-lg p-6 bg-gray-50 relative group">
                
                <!-- Product Header -->
                <div class="flex justify-between items-center mb-4 border-b pb-2">
                    <div class="flex items-center gap-3">
                        <select v-model="product.name" class="text-lg font-bold bg-transparent border-none focus:ring-0 p-0 text-gray-800">
                            <option v-for="pName in availableProductNames" :value="pName">{{ pName }}</option>
                        </select>
                        <span class="bg-gray-200 text-gray-700 text-xs px-2 py-1 rounded">Weight: {{ getProductWeight(product.name) }}x</span>
                    </div>
                    <button @click="removeProduct(pIndex)" class="text-red-500 hover:text-red-700 text-sm font-semibold">Remove Product</button>
                </div>

                <!-- Modules Table -->
                <table class="w-full text-sm text-left text-gray-500 mb-4">
                    <thead class="text-xs text-gray-700 uppercase bg-gray-200">
                        <tr>
                            <th scope="col" class="px-4 py-3">Module Name</th>
                            <th scope="col" class="px-4 py-3 w-32">Features</th>
                            <th scope="col" class="px-4 py-3 w-32">Personalizations</th>
                            <th scope="col" class="px-4 py-3 w-10"></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr v-for="(module, mIndex) in product.modules" :key="mIndex" class="bg-white border-b hover:bg-gray-50">
                            <td class="px-4 py-2">
                                <input v-model="module.name" type="text" class="w-full bg-transparent border-none focus:ring-0" placeholder="e.g. Purchasing">
                            </td>
                            <td class="px-4 py-2">
                                <input v-model.number="module.features" type="number" class="w-full bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded focus:ring-blue-500 focus:border-blue-500 block p-1" min="0">
                            </td>
                            <td class="px-4 py-2">
                                <input v-model.number="module.personalizations" type="number" class="w-full bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded focus:ring-blue-500 focus:border-blue-500 block p-1" min="0">
                            </td>
                            <td class="px-4 py-2 text-center">
                                <button @click="removeModule(pIndex, mIndex)" class="text-red-400 hover:text-red-600">Ã—</button>
                            </td>
                        </tr>
                    </tbody>
                </table>

                <button @click="addModule(pIndex)" class="text-blue-600 hover:text-blue-800 text-sm font-semibold flex items-center gap-1">
                    + Add Module
                </button>

                <!-- Product Summary -->
                <div class="mt-4 bg-white p-3 rounded border border-gray-200 flex justify-between items-center text-sm">
                    <div class="text-gray-600">
                        <span class="font-bold">{{ product.modules.reduce((sum, m) => sum + m.features, 0) }}</span> Features &nbsp;|&nbsp;
                        <span class="font-bold">{{ product.modules.reduce((sum, m) => sum + m.personalizations, 0) }}</span> Personalizations
                    </div>
                    <div class="text-gray-400 text-xs">Complexity Weight applied in calculation</div>
                </div>
            </div>

            <!-- Grand Total Summary -->
            <div class="bg-gray-800 text-white p-6 rounded-lg mt-8">
                <h3 class="text-xl font-bold mb-4">Estimation Summary</h3>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div>
                        <div class="text-gray-400 text-xs uppercase">Total Features</div>
                        <div class="text-2xl font-bold">{{ grandTotals.features }}</div>
                    </div>
                    <div>
                        <div class="text-gray-400 text-xs uppercase">Total Personalizations</div>
                        <div class="text-2xl font-bold">{{ grandTotals.personalizations }}</div>
                    </div>
                    <div>
                        <div class="text-gray-400 text-xs uppercase">Est. CSU (Hours)</div>
                        <div class="text-2xl font-bold text-green-400">{{ grandTotals.csu }}</div>
                    </div>
                    <div>
                        <div class="text-gray-400 text-xs uppercase">Products</div>
                        <div class="text-2xl font-bold">{{ products.length }}</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const { createApp } = Vue;

    createApp({
        data() {
            return {
                customerName: "Global Enterprises",
                availableProductNames: [
                    "SCM Common Components", "Inventory Management", "Maintenance", "Manufacturing",
                    "Order Management", "Collaboration Messaging Framework", "Procurement",
                    "Product Hub", "Purchasing", "Quality Management", "Self Service Procurement & RSSP",
                    "Supply Chain Collaboration", "Supply Chain Orchestration", "Supply Chain Planning"
                ],
                productWeights: {
                    "SCM Common Components": 0.5, "Inventory Management": 1.2, "Maintenance": 1.2,
                    "Manufacturing": 1.5, "Order Management": 1.0, "Collaboration Messaging Framework": 1.0,
                    "Procurement": 1.0, "Product Hub": 1.0, "Purchasing": 1.0, "Quality Management": 1.1,
                    "Self Service Procurement & RSSP": 1.0, "Supply Chain Collaboration": 1.0,
                    "Supply Chain Orchestration": 1.1, "Supply Chain Planning": 1.2
                },
                products: [
                    {
                        name: "Procurement",
                        modules: [
                            { name: "Purchasing", features: 30, personalizations: 20 },
                            { name: "Sourcing", features: 0, personalizations: 0 }
                        ]
                    }
                ]
            }
        },
        computed: {
            grandTotals() {
                let totalFeatures = 0;
                let totalPers = 0;
                let totalCSU = 0;

                this.products.forEach((p, index) => {
                    const pFeatures = p.modules.reduce((sum, m) => sum + m.features, 0);
                    const pPers = p.modules.reduce((sum, m) => sum + m.personalizations, 0);
                    
                    totalFeatures += pFeatures;
                    totalPers += pPers;

                    const weight = this.getProductWeight(p.name);
                    const adoptionCSU = (pFeatures * 0.2) + (pFeatures * 16 * weight) + (pPers * 2); 
                    totalCSU += adoptionCSU;
                });

                return {
                    features: totalFeatures,
                    personalizations: totalPers,
                    csu: Math.round(totalCSU)
                };
            }
        },
        methods: {
            getProductWeight(name) {
                return this.productWeights[name] || 1.0;
            },
            addProduct() {
                this.products.push({
                    name: "Procurement",
                    modules: [{ name: "New Module", features: 0, personalizations: 0 }]
                });
            },
            removeProduct(index) {
                if(this.products.length > 1) {
                    this.products.splice(index, 1);
                } else {
                    alert("You must have at least one product.");
                }
            },
            addModule(pIndex) {
                this.products[pIndex].modules.push({ name: "New Module", features: 0, personalizations: 0 });
            },
            removeModule(pIndex, mIndex) {
                this.products[pIndex].modules.splice(mIndex, 1);
            },
            
            generateExcel() {
                const wb = XLSX.utils.book_new();
                const totalPersonalizationsAllProducts = this.grandTotals.personalizations;

                // 1. Create Summary Sheet with proper formatting
                const summaryData = [];
                
                // Header row
                summaryData.push(["Product", "Module", "Features", "Personalization", "Complexity", "CSU Features", "Actual CSU"]);
                
                let grandTotalFeatures = 0;
                let grandTotalPers = 0;
                let grandTotalCSUFeatures = 0;
                let grandTotalActualCSU = 0;

                this.products.forEach((product, pIdx) => {
                    const pFeatures = product.modules.reduce((sum, m) => sum + m.features, 0);
                    const pPers = product.modules.reduce((sum, m) => sum + m.personalizations, 0);
                    const weight = this.getProductWeight(product.name);
                    
                    // Calculate CSU for this product (simplified for summary)
                    const csuFeatures = Math.round(pFeatures * (0.1 + 0.1 + (8 * weight)) + (pPers * 2));
                    const actualCSU = csuFeatures;

                    // Add modules
                    product.modules.forEach(mod => {
                        summaryData.push([
                            product.name,
                            mod.name,
                            mod.features,
                            mod.personalizations,
                            "",
                            "",
                            ""
                        ]);
                    });

                    // Product total row
                    summaryData.push([
                        "",
                        "Total",
                        pFeatures,
                        pPers,
                        weight,
                        csuFeatures,
                        actualCSU
                    ]);

                    grandTotalFeatures += pFeatures;
                    grandTotalPers += pPers;
                    grandTotalCSUFeatures += csuFeatures;
                    grandTotalActualCSU += actualCSU;
                });

                // Grand total row
                summaryData.push([
                    "",
                    "Grand Total",
                    grandTotalFeatures,
                    grandTotalPers,
                    "",
                    grandTotalCSUFeatures,
                    grandTotalActualCSU
                ]);

                const wsSummary = XLSX.utils.aoa_to_sheet(summaryData);
                
                // Set column widths for summary
                wsSummary['!cols'] = [
                    { wch: 25 }, { wch: 35 }, { wch: 12 }, { wch: 15 }, { wch: 12 }, { wch: 15 }, { wch: 12 }
                ];

                XLSX.utils.book_append_sheet(wb, wsSummary, "Summary");

                // 2. Create Product Sheets
                this.products.forEach((product, index) => {
                    const isFirstChild = index === 0;
                    const pFeatures = product.modules.reduce((sum, m) => sum + m.features, 0);
                    const pPers = product.modules.reduce((sum, m) => sum + m.personalizations, 0);
                    const weight = this.getProductWeight(product.name);

                    const pData = [];
                    
                    // Title
                    pData.push([`REDWOOD ADOPTION ESTIMATION - ${product.name.toUpperCase()}`]);
                    pData.push([]);
                    
                    // Customer info
                    pData.push(["Customer:", this.customerName, "", "", "Features:", pFeatures]);
                    pData.push(["Date:", "=TODAY()", "", "", "Personalization:", pPers]);
                    pData.push([]);

                    let sectionNum = 1;

                    // Helper function to add section
                    const addSection = (title, activities) => {
                        pData.push([title]);
                        pData.push(["Activity", "Detailed Activity", "Non Prod", "Prod", "Qty", "Total", "CSUs"]);
                        
                        activities.forEach((act, actIdx) => {
                            const rowNum = pData.length + 1;
                            const rowLetter = String.fromCharCode(65 + (actIdx % 26));
                            pData.push([
                                act.name,
                                act.desc,
                                act.nonProd,
                                act.prod,
                                act.qty,
                                `=(C${rowNum}+D${rowNum})*E${rowNum}`,
                                `=F${rowNum}/2`
                            ]);
                        });

                        // Section total
                        const totalRow = pData.length + 1;
                        pData.push([
                            "Section Total",
                            "",
                            "",
                            "",
                            "",
                            `=SUM(F${totalRow-activities.length}:F${totalRow-1})`,
                            `=SUM(G${totalRow-activities.length}:G${totalRow-1})`
                        ]);
                        pData.push([]);
                    };

                    // 1. Assessment Activities (First Product Only)
                    if (isFirstChild) {
                        pData.push(["1. ASSESSMENT ACTIVITIES"]);
                        pData.push(["Activity", "Detailed Activity", "Non Prod", "Prod", "Qty", "Total", "CSUs"]);
                        
                        const assessmentActivities = [
                            { name: "Discussion", desc: "Introduction of Redwood Features along with redwood roadmap of Supply Chain. Prepare Inventory of assets impacted, Report and the Workplan and Review Workplan with the Customer", nonProd: 8, prod: 0, qty: 1 },
                            { name: "Documentation", desc: "This covers various documentation like CWB's and Adoption Document", nonProd: 16, prod: 0, qty: 1 },
                            { name: "Demo/Review", desc: "Walk Through of Applicable Feature Before and After Adoption along with few transactions in the system", nonProd: 8, prod: 0, qty: 1 }
                        ];

                        assessmentActivities.forEach((act, idx) => {
                            const rowNum = pData.length + 1;
                            pData.push([
                                act.name,
                                act.desc,
                                act.nonProd,
                                act.prod,
                                act.qty,
                                `=(C${rowNum}+D${rowNum})*E${rowNum}`,
                                `=F${rowNum}/2`
                            ]);
                        });

                        const totalRow = pData.length + 1;
                        pData.push([
                            "Section Total",
                            "",
                            "",
                            "",
                            "",
                            `=SUM(F${totalRow-3}:F${totalRow-1})`,
                            `=SUM(G${totalRow-3}:G${totalRow-1})`
                        ]);
                        pData.push([]);
                        sectionNum++;
                    }

                    // 2. Adoption Activities (All Products)
                    pData.push([`${sectionNum}. ADOPTION ACTIVITIES - ${product.name.toUpperCase()}`]);
                    pData.push(["Activity", "Detailed Activity", "Non Prod", "Prod", "Qty", "Total", "CSUs"]);
                    
                    const adoptionActivities = [
                        { name: "Features Enablement", desc: "Enabling Feature by Feature by setup, Profile option, Opt-in Enablement", nonProd: 0.1, prod: 0.1, qty: pFeatures },
                        { name: "Verification of Enabled Features at Config Level", desc: "Once All the features are enabled, verified all features enablement", nonProd: 0.1, prod: 0.1, qty: pFeatures },
                        { name: "Verification of Enabled Features at UI", desc: `Verification of enabled functionality in Redwood UI (Product weight: ${weight}x)`, nonProd: 8 * weight, prod: 8 * weight, qty: 1 },
                        { name: "Enablement of Personalization", desc: "Redo personalizations. With the shift to the Redwood architecture, many existing personalizations from the Classic version will not automatically migrate due to structural differences", nonProd: 2, prod: 0, qty: pPers },
                        { name: "Additional Personalization - Expected", desc: "Perform Additional personalization based on customer testing and inputs. This is again during testing", nonProd: 2, prod: 0, qty: Math.max(1, Math.floor(pPers * 0.1)) }
                    ];

                    adoptionActivities.forEach((act, idx) => {
                        const rowNum = pData.length + 1;
                        pData.push([
                            act.name,
                            act.desc,
                            act.nonProd,
                            act.prod,
                            act.qty,
                            `=(C${rowNum}+D${rowNum})*E${rowNum}`,
                            `=F${rowNum}/2`
                        ]);
                    });

                    const adoptionTotalRow = pData.length + 1;
                    pData.push([
                        "Section Total",
                        "",
                        "",
                        "",
                        "",
                        `=SUM(F${adoptionTotalRow-5}:F${adoptionTotalRow-1})`,
                        `=SUM(G${adoptionTotalRow-5}:G${adoptionTotalRow-1})`
                    ]);
                    pData.push([]);
                    sectionNum++;

                    // 3. Unit Testing Activities (First Product Only)
                    if (isFirstChild) {
                        pData.push([`${sectionNum}. UNIT TESTING ACTIVITIES AND UAT ASSISTANCE`]);
                        pData.push(["Activity", "Detailed Activity", "Non Prod", "Prod", "Qty", "Total", "CSUs"]);
                        
                        const uatActivities = [
                            { name: "Perform Unit Testing with and without personalization involved", desc: "Perform a detailed column-by-column comparison between Classic and Redwood to confirm that all data points and configurations are accurately mapped, helping ensure that no field, functionality, or dependency is missed during the transition", nonProd: 40, prod: 0, qty: 1 },
                            { name: "Comparison between Classic vs Redwood - W.O", desc: "Column by Column comparison between Classic and Redwood to ensure everything is covered", nonProd: 24, prod: 0, qty: 1 },
                            { name: "Assist in Test instance and UAT to resolve any Redwood issues raised during Testing", desc: "Assist in Test instance and UAT to resolve any Redwood issues raised during Testing", nonProd: 24, prod: 0, qty: 1 }
                        ];

                        uatActivities.forEach((act, idx) => {
                            const rowNum = pData.length + 1;
                            pData.push([
                                act.name,
                                act.desc,
                                act.nonProd,
                                act.prod,
                                act.qty,
                                `=(C${rowNum}+D${rowNum})*E${rowNum}`,
                                `=F${rowNum}/2`
                            ]);
                        });

                        const uatTotalRow = pData.length + 1;
                        pData.push([
                            "Section Total",
                            "",
                            "",
                            "",
                            "",
                            `=SUM(F${uatTotalRow-3}:F${uatTotalRow-1})`,
                            `=SUM(G${uatTotalRow-3}:G${uatTotalRow-1})`
                        ]);
                        pData.push([]);
                        sectionNum++;
                    }

                    // 4. Migration Activities (First Product Only)
                    if (isFirstChild) {
                        pData.push([`${sectionNum}. MIGRATION ACTIVITIES`]);
                        pData.push(["Activity", "Detailed Activity", "Non Prod", "Prod", "Qty", "Total", "CSUs"]);
                        
                        const migrationActivities = [
                            { name: "Configure Setups and Deploy Personalization to another non-Prod environment as per customer environment selected", desc: "Configure Setups and Deploy Personalization to another non-Prod environment as per customer environment selected", nonProd: 0.1, prod: 0.1, qty: totalPersonalizationsAllProducts },
                            { name: "Configuration of Setups and Deployment of Personalization to Prod environment", desc: "Production Migration of UI, setups and Personalizations done and signed off by customer", nonProd: 0, prod: 1, qty: totalPersonalizationsAllProducts },
                            { name: "Assist Customer in Configuration of Setups and Deployment of Personalization to Prod environment (Optional)", desc: "Migration to production environment depending on customer's discussion. In this a migration documentation will be provided and assist customer in Moving to Redwood for Production", nonProd: 0, prod: 1, qty: 0 }
                        ];

                        migrationActivities.forEach((act, idx) => {
                            const rowNum = pData.length + 1;
                            pData.push([
                                act.name,
                                act.desc,
                                act.nonProd,
                                act.prod,
                                act.qty,
                                `=(C${rowNum}+D${rowNum})*E${rowNum}`,
                                `=F${rowNum}/2`
                            ]);
                        });

                        const migrationTotalRow = pData.length + 1;
                        pData.push([
                            "Section Total",
                            "",
                            "",
                            "",
                            "",
                            `=SUM(F${migrationTotalRow-3}:F${migrationTotalRow-1})`,
                            `=SUM(G${migrationTotalRow-3}:G${migrationTotalRow-1})`
                        ]);
                        pData.push([]);
                        sectionNum++;
                    }

                    // 5. Post-Go-Live Hypercare Support (First Product Only)
                    if (isFirstChild) {
                        pData.push([`${sectionNum}. POST-GO-LIVE HYPERCARE SUPPORT`]);
                        pData.push(["Activity", "Detailed Activity", "Non Prod", "Prod", "Qty", "Total", "CSUs"]);
                        
                        const hypercareQty = Math.max(8, Math.floor(totalPersonalizationsAllProducts * 0.2));
                        
                        const hypercareActivities = [
                            { name: "Post Go-live Support", desc: "Hypercare for 3 weeks to support all the requirement and issues", nonProd: 0, prod: 4, qty: hypercareQty }
                        ];

                        hypercareActivities.forEach((act, idx) => {
                            const rowNum = pData.length + 1;
                            pData.push([
                                act.name,
                                act.desc,
                                act.nonProd,
                                act.prod,
                                act.qty,
                                `=(C${rowNum}+D${rowNum})*E${rowNum}`,
                                `=F${rowNum}/2`
                            ]);
                        });

                        const hypercareTotalRow = pData.length + 1;
                        pData.push([
                            "Section Total",
                            "",
                            "",
                            "",
                            "",
                            `=SUM(F${hypercareTotalRow-1}:F${hypercareTotalRow-1})`,
                            `=SUM(G${hypercareTotalRow-1}:G${hypercareTotalRow-1})`
                        ]);
                        pData.push([]);
                    }

                    // Grand Total
                    const grandTotalRow = pData.length + 1;
                    pData.push([
                        "GRAND TOTAL",
                        "",
                        "",
                        "",
                        "",
                        `=SUM(F2:F${grandTotalRow-1})`,
                        `=SUM(G2:G${grandTotalRow-1})`
                    ]);

                    const wsProduct = XLSX.utils.aoa_to_sheet(pData);
                    
                    // Set column widths
                    wsProduct['!cols'] = [
                        { wch: 35 }, { wch: 60 }, { wch: 12 }, { wch: 12 }, { wch: 8 }, { wch: 15 }, { wch: 12 }
                    ];

                    XLSX.utils.book_append_sheet(wb, wsProduct, product.name);
                });

                // Save file
                XLSX.writeFile(wb, "Redwood_Adoption_Estimator.xlsx");
            }
        }
    }).mount('#app');
</script>

</body>
</html>
```
